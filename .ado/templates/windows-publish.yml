parameters:
  - name: Flavor
  - name: Architecture
  - name: IncludeHeaders
    type: boolean
    default: false

steps:
  - task: CopyFiles@2
    displayName: Stage headers
    condition: ${{ parameters.IncludeHeaders }}
    inputs:
      sourceFolder: $(Build.SourcesDirectory)/include
      targetFolder: $(Build.ArtifactStagingDirectory)/include
      contents: '**'

  - task: CopyFiles@2
    displayName: Stage library
    inputs:
      sourceFolder: $(Build.BinariesDirectory)/${{ parameters.Flavor }}/${{ parameters.Architecture }}/src/Continuity
      targetFolder: $(Build.ArtifactStagingDirectory)/${{ parameters.Flavor }}/${{ parameters.Architecture }}
      contents: |
        Continuity.dll
        Continuity.lib
        Continuity.pdb

  - task: PublishPipelineArtifact@1
    displayName: Publish artifacts
    inputs:
      path: $(Build.ArtifactStagingDirectory)
      artifactName: Windows-${{ parameters.Flavor }}-${{ parameters.Architecture }}
